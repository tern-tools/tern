# -*- coding: utf-8 -*-
#
# Copyright (c) 2019 VMware, Inc. All Rights Reserved.
# SPDX-License-Identifier: BSD-2-Clause

"""
Execute cve-bin-tool
https://github.com/intel/cve-bin-tool
This plugin does not support installation of cve-bin-tool
The assumption is that cve-bin-tool is globally executable
"""

from tern.analyze import passthrough
from tern.extensions.executor import Executor


class CveBinTool(Executor):
    '''Execute cve-bin-tool'''
    def exec(self, image_obj):
        '''Execution should be:
            cve-bin-tool -q /path/to/directory
        '''
        command = 'cve-bin-tool -q'
        passthrough.analyze_image_external(image_obj, command)
